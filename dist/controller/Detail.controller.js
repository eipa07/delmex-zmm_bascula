sap.ui.define(["delmex/zmmbascula/controller/BaseController","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/m/PDFViewer","delmex/zmmbascula/util/formatter"],(e,t,a,o,r,i,n)=>{"use strict";return e.extend("delmex.zmmbascula.controller.Detail",{formatter:n,onInit(){var e=this.getRouter();e.getRoute("RouteDetail").attachMatched(this._onObjectMatched,this);this._pdfViewer=new i({title:"Vista previa del PDF"});this.getView().addDependent(this._pdfViewer);var t=new sap.ui.model.json.JSONModel;t.loadData("./model/PDF_Structure.json",false);this.getView().setModel(t,"pdfStructureModel");let a=this.detailSettingsModel();this.getView().setModel(a,"settingsModel")},_onObjectMatched(e){var a=e.getParameter("arguments");var o=a.folio;var i=this;var n=this.getView().getModel("zbasc");var s="/Z_ALTA_Set('"+o+"')";n.read(s,{success:function(e,a){let o=new t;o.setData(e);i.getView().setModel(o,"basculaDetails")},error:function(e){r.error(e)}})},goBackBtn(){this.goBack()},onShowPDF:function(){const{jsPDF:e}=window.jspdf;const t=new e;var a=this.getView().getModel("pdfStructureModel").getData().Structure;var o=this.getView().getModel("basculaDetails").getData();const r=t.internal.pageSize.getWidth();const i=90;const n=30;const s=(r-i)/2;const d=10;var l=10;var c=12;t.setFontSize(l);const x=t.getTextWidth(a.Header.Line1);const g=(r-x)/2;const u=t.getTextWidth(a.Header.Line2);const h=(r-u)/2;const m=t.getTextWidth(a.Header.Line3);const p=(r-m)/2;const v=t.getTextWidth(a.Header.Line4);const L=(r-v)/2;const H=t.getTextWidth(a.Header.Line5);const w=(r-H)/2;const f=t.getTextWidth(a.Header.Line6);const D=(r-f)/2;const F=t.getTextWidth(a.Header.Line7);const B=(r-F)/2;var _=a.Body.Folio+o.Folio;const M=sap.ui.require.toUrl("delmex/zmmbascula/images/Logo.png");this.loadImageAsBase64(M,function(e){t.addImage(e,"PNG",s,20,i,n);t.setTextColor(7,31,99);t.setFont("helvetica","bolditalic");t.text(a.Header.Line1,g,70);t.text(a.Header.Line2,h,75);t.text(a.Header.Line3,p,80);t.text(a.Header.Line4,L,85);t.text(a.Header.Line5,w,90);t.text(a.Header.Line6,D,95);t.text(a.Header.Line7,B,100);t.setFontSize(c);t.text(_,r-(d+40),115,{align:"right"});const l=20;var x=a.Body.Placa;var u=a.Body.Bruto;var m=a.Body.Bound;var v=a.Body.Fecha_Hora_SALIDA_1;var H=a.Body.Bruto;var f=a.Body.Called_Neto;var F=a.Body.Fecha_Hora_SALIDA_2;t.setFont("helvetica","italic");t.text(x,l,140);t.text(o.Placa,l+30,140);t.text(a.Helpers.Line,l+30,141);t.text(u,l,150);t.text(m,l,155);t.text(o.Pesaje,l+30,155);t.text(a.Helpers.Line,l+30,156);var M=this.formatter.formatDate(o.FechaEntBas);t.text(v,l,165);t.text(F,l,170);t.text(M,60,170);t.text(a.Helpers.Line,l+40,171);t.text(x,l,185);t.text(o.Placa,l+30,185);t.text(a.Helpers.Line,l+30,186);t.text(H,l,200);t.text(o.Pesaje2,l+30,200);t.text(a.Helpers.Line,l+30,201);t.text(f,l,215);t.text(o.PesoNeto,l+40,215);t.text(a.Helpers.Line,l+40,216);t.text(v,l,225);t.text(F,l,230);t.text(M,60,230);t.text(a.Helpers.Line,l+40,231);var b=a.Footer.Nombre;var S=a.Footer.Referencia_Material;var P=a.Footer.No_Doc+o.NumeroDoc;t.text(b,l,250);t.text(o.Conductor,60,250);t.text(a.Helpers.Line,l+40,251);t.text(x,l,260);t.text(o.Folio,60,260);t.text(a.Helpers.Line,l+40,261);t.text(S,l,270);t.text(o.NumeroDoc,60,270);t.text(a.Helpers.Line,l+60,271);t.text(P,l,280);t.text("Pendiente - orden de venta",100,280);t.text(a.Helpers.Line,l+60,281);const V=t.output("blob");const j=URL.createObjectURL(V);this._pdfViewer.setSource(j);this._pdfViewer.open()}.bind(this))},loadImageAsBase64:function(e,t){var a=new Image;a.onload=function(){var e=document.createElement("canvas");e.width=a.width;e.height=a.height;var o=e.getContext("2d");o.drawImage(a,0,0);var r=e.toDataURL("image/png");t(r)};a.src=e}})});
//# sourceMappingURL=Detail.controller.js.map